TODO:
chunk size should be rectangle not a square
